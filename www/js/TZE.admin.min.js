/*!
 * Script für TZE (0.1.0) - Erstellt am 25-06-2015
 *
 * Copyright (c) 2015, Johannes Boost <jjjb at usw-tools.de>
 * 
 * Lizenziert unter: Creative Commons Lizenzvertrag - CC-BY-NC-SA-3.0
 * Namensnennung - Nicht-kommerziell - Weitergabe unter gleichen Bedingungen
 * http://creativecommons.org/licenses/by-nc-sa/3.0/de/legalcode
 */
function getOptions(a,b){var c=[];return $.ajax({url:a,type:"POST",dataType:"json",async:!1,data:b,success:function(a){c=a.Options}}),c}function actionFunc(a,b,c,d,e){function f(a,b){void 0!==b&&$.each(b,function(b,c){$.each(a,function(a,b){a===c.key&&$(c.elem).data(a,b)})})}return $.each([c,d],function(a,c){if(void 0!==c){var d=$.param(c);d.length>0&&(b+="&"+d)}}),$.Deferred(function(c){$.ajax({url:a,type:"POST",dataType:"json",data:b,success:function(a){f(a,e),c.resolve(a)},error:function(){c.reject()}})})}var dispocodes=function(a){var b={};return b.init=function(b){this.jtable=a(b);var c=this.jtable;c.jtable({title:"&nbsp;",sorting:!0,fields:{id:{key:!0,list:!1},code:{title:"Nummer"},ListLabel:{title:"Name für Liste"},ButtonLabel:{title:"Name für Button"},"class":{title:"Klasse"},position:{list:!1,title:"Rangfolge"},usual:{list:!1,title:"Gruppe",type:"combobox",options:{1:"Übliche Liste",0:"Versteckte Liste"}}},actions:{listAction:function(a,b){return actionFunc("func/dispocodes.php","mode=admin&action=list&",b)},createAction:function(a){return actionFunc("func/dispocodes.php","mode=admin&action=insert&"+a)},updateAction:function(a){return actionFunc("func/dispocodes.php","mode=admin&action=update&"+a)},deleteAction:function(a){return actionFunc("func/dispocodes.php","mode=admin&action=delete&id="+a.id)}}}).jtable("load")},b.destroy=function(){this.jtable.jtable("destroy"),delete this.jtable},b}(jQuery),mitarbeiter=function(a){var b={};return b.init=function(){b.table=a("#mitarbeiter"),b.table.jtable({title:"&nbsp;",sorting:!0,defaultSorting:"sNachname ASC",paging:!0,pageSizes:[10,20,50,100],pageSize:20,actions:{listAction:function(a,b){return actionFunc("func/mitarbeiter.php","mode=admin&action=list&",b,a)},createAction:function(a){return actionFunc("func/mitarbeiter.php","mode=admin&action=insert&"+a)},updateAction:function(a){return actionFunc("func/mitarbeiter.php","mode=admin&action=update&"+a)},deleteAction:function(a){return actionFunc("func/mitarbeiter.php","mode=admin&action=delete&userId="+a.userId)}},fields:{userId:{key:!0,list:!1},maId:{title:"Kürzel",inputClass:"validate[required]"},sVorname:{title:"Vorname",inputClass:"validate[required]"},sNachname:{title:"Nachname",inputClass:"validate[required]"},sLogin:{title:"Login",inputClass:"validate[required]"},sMail:{title:"E-Mail",inputClass:"validate[required]"},iArbeitszeit:{title:"AZ",inputClass:"validate[required]"},bZeitarbeiter:{title:"Leih-A.",type:"combobox",options:{0:"Nein",1:"Ja"}},bLogin_Allowed:{title:"Freig.",type:"combobox",options:{0:"Nein",1:"Ja"}},iAdmin:{title:"Zugriff",type:"combobox",options:{0:"Nutzer",1:"Admin"}},sPassword_hash:{title:"Passwort",list:!1,create:!1,type:"checkbox",values:{"":"keine Änderung",neuespw:"Neues Passwort vergeben"}},bForce_Update_PW:{create:!1,list:!1,title:"Muss neues Passwort erstellen?",type:"checkbox",values:{0:"Nein",1:"Ja"}}},formCreated:function(a,b){},formSubmitting:function(a,b){},formClosed:function(a,b){},recordUpdated:function(a,b){if("undefined"!=typeof b.serverResponse.Password){var c="Hallo "+b.record.sVorname+",\n\nhiermit erhältst du dein Login für unsere Zeiterfassung:\n\nLogin:\n"+b.record.sLogin+"\n\nPasswort:\n"+b.serverResponse.Password+"\n\nDie Zeiterfassung erreichst du unter folgender Adresse:\nhttps://"+window.location.hostname+"/\n\nBitte beachte, dass die Seite erst ab Version 10 des Internet Explorers korrekt angezeigt wird, eventuell musst du also einen anderen Browser verwenden.",d=encodeURI(c),e=encodeURI("Login für Zeiterfassung");bootbox.alert({title:"Neuer Passwort",message:"<p>Für "+b.record.sVorname+" "+b.record.sNachname+' wurde ein neues Passwort erstellt.</p><div class="alert alert-info"><strong>Hinweis:</strong> Passwort muss beim nächsten Login geändert werden!</div><div class="form-group"><label>Login</label><pre>'+b.record.sLogin+'</pre></div><div class="form-group"><label>Passwort</label><pre>'+b.serverResponse.Password+'</pre></div><p><a href="mailto:'+b.record.sMail+"?subject="+e+"&body="+d+'" target="_blank">Per E-Mail versenden</a></p>'})}},recordAdded:function(a,b){var c="Hallo "+b.record.sVorname+",\n\nhiermit erhältst du dein Login für unsere Zeiterfassung:\n\nLogin:\n"+b.record.sLogin+"\n\nPasswort:\n"+b.serverResponse.Password+"\n\nDie Zeiterfassung erreichst du unter folgender Adresse:\nhttps://"+window.location.hostname+"/\n\nBitte beachte, dass die Seite erst ab Version 10 des Internet Explorers korrekt angezeigt wird, eventuell musst du also einen anderen Browser verwenden.",d=encodeURI(c),e=encodeURI("Login für Zeiterfassung");bootbox.alert({title:"Neuer Mitarbeiter",message:"<p>Das Login für "+b.record.sVorname+" "+b.record.sNachname+' wurde erstellt.</p><div class="alert alert-info"><strong>Hinweis:</strong> Passwort muss beim nächsten Login geändert werden!</div><div class="form-group"><label>Login</label><pre>'+b.record.sLogin+'</pre></div><div class="form-group"><label>Passwort</label><pre>'+b.serverResponse.Password+'</pre></div><p><a href="mailto:'+b.record.sMail+"?subject="+e+"&body="+d+'" target="_blank">Per E-Mail versenden</a></p>'})},toolbar:{items:[{text:'Filter: <input id="nameFilter" name="nameFilter" style="width: 6em; margin: -5px 0px; border: none;" type="text" />'},{text:'<span name="undelete">gelöschte Mitarbeiter<span>'}]}}),a("#mitarbeiter").on("keydown",'input[name="nameFilter"]',function(){void 0!==b.updateTimer&&clearTimeout(b.updateTimer);var c=a(this);b.updateTimer=setTimeout(function(){delete b.updateTimer,b.table.jtable("load",{nameFilter:c.val()})},400)}),a("#mitarbeiter").on("click",'span[name="undelete"]',function(){var c=tze.showProcess();a.post("func/mitarbeiter.php",{mode:"admin",action:"list-deleted"},function(d){if(tze.hideProcess(c,!0),"OK"===d.Result){var e=a('<select name="undelSelection" class="form-control"></select>'),f=a('<div class="col-sm-8"></div>').append(e),g=a('<div class="form-group"></div>').append("<div class='col-sm-4 control-label'>Gelöschte Mitarbeiter</div>").append(f),h=a('<form class="form-horizontal"></form>').append(g);e.append('<option style="display: none;">bitte auswählen</option>'),a.each(d.Records,function(){e.append('<option value="'+this.userId+'">'+this.name+"</option>")}),bootbox.confirm({title:"Mitarbeiter wiederherstellen",message:h,closeButton:!1,animate:!1,backdrop:!0,callback:function(c){if(c){var d=a('select[name="undelSelection"]').val();""!==d&&a.post("func/mitarbeiter.php",{mode:"admin",action:"undelete",userId:d},function(a){"OK"===a.Result?b.table.jtable("reload"):void 0!==a.Message&&bootbox.alert(a.Message)},"json")}}})}else void 0!==d.Message&&bootbox.alert(d.Result)},"json")})},b}(jQuery),projekte=function(a){var b={};return b.init=function(){a("#projekte").jtable({openChildAsAccordion:!0,title:"&nbsp;",fields:{id:{key:!0,list:!1},Projekt:{title:"Projekte"},MA:{create:!1,edit:!1,display:function(b){var c=a('<button style="width: 100%">zugeordnete Mitarbeiter</button>');return c.on("click",function(){a("#projekte").jtable("openChildTable",c.closest("tr"),{title:b.record.Projekt+" - zugeordnete Mitarbeiter",fields:{iUser:{key:!0,list:!1,title:"Mitarbeiter",create:!0,options:getOptions("func/projekte.php","mode=admin&action=projekt-get-users-detached&id="+b.record.id)},sVorname:{title:"Vorname",create:!1},sNachname:{title:"Nachname",create:!1},sLogin:{title:"Login",create:!1}},actions:{listAction:function(){return actionFunc("func/projekte.php","mode=admin&action=projekt-get-users-attached&id="+b.record.id)},createAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-add-user&data=json&id="+b.record.id+"&"+a)},deleteAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-del-user&data=json&id="+b.record.id+"&iUser="+a.iUser)}}},function(a){a.childTable.jtable("load")})}),c}},Tickets:{create:!1,edit:!1,display:function(b){var c=a('<button style="width: 100%">Ticketarten</button>');return c.on("click",function(){a("#projekte").jtable("openChildTable",c.closest("tr"),{title:b.record.Projekt+" - Ticketarten",fields:{ticketId:{key:!0,list:!1},ticketName:{title:"Name"},undoneSwitch:{title:"Abschluss",options:{0:"Immer",1:"Wählbar"}},ticketNumberSwitch:{title:"Ticketnummer",options:{1:"keine",2:"Optional",3:"Erforderlich"}},counterSwitch:{title:"Anzahl",options:{1:"keine",2:"Optional",3:"Erforderlich"}},counterName:{title:"Name für Anzahl"},durationSwitch:{title:"Dauer",options:{1:"keine",2:"Optional",3:"Erforderlich"}},shortcut:{title:"Taste"},charge_ticket:{title:"€/Ticket"},charge_counter:{title:"€/Anzahl"},charge_duration:{title:"€/Minute"}},actions:{listAction:function(){return actionFunc("func/projekte.php","mode=admin&action=projekt-ticket-list&projektId="+b.record.id)},createAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-ticket-create&projektId="+b.record.id+"&"+a)},updateAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-ticket-update&projektId="+b.record.id+"&"+a)},deleteAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-ticket-delete&projektId="+b.record.id+"&ticketId="+a.ticketId)}}},function(a){a.childTable.jtable("load")})}),c}}},actions:{listAction:function(){return actionFunc("func/projekte.php","mode=admin&action=projekt-list")},updateAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-set-name&"+a)},deleteAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-delete&id="+a.id)},createAction:function(a){return actionFunc("func/projekte.php","mode=admin&action=projekt-create&"+a)}}})},b}(jQuery),tickets=function(a){var b={};return b.filter={},b.init=function(c,d){this.$jtable=a(c),this.$datepicker=a(d);var e=this.$jtable,f=this.$datepicker;f.datepicker({dateFormat:"yy-mm-dd"}).on("change",function(){a.extend(b.filter,{Date:a(this).val()}),e.jtable("load",b.filter)}),e.jtable({title:"&nbsp;",fields:{id:{key:!0,list:!1},Projekt:{title:"Projekt",width:"30%"},Tickets:{title:"Zusammenfassung",width:"43%",display:function(a){var b=a.record.charge_tickets,c=a.record.done_tickets,d=a.record.sum_counter,e=a.record.sum_duration;return"Tickets: "+b+" (Gesamt: "+c+", Einheiten: "+d+", Zeit: "+e+")"}},perMA:{title:"",width:"12%",display:function(c){var d=a("<button>per MA</button>");return d.on("click",function(){b.childperMA(d,c.record)}),d}},perTA:{title:"",width:"15%",display:function(c){var d=a("<button>per Ticket</button>");return d.on("click",function(){b.childperTA(d,c.record)}),d}}},actions:{listAction:function(a,b){return actionFunc("func/tickets.php","mode=admin&action=list",b,a)}},toolbar:{items:[{text:'<div><span class="glyphicon glyphicon-refresh"></span> Aktualisieren</div>',click:function(){e.jtable("reload")}},{text:'<div><span class="glyphicon glyphicon-download-alt"></span> Excel-Report</div>',click:function(){b.Report(f.val())}}]}}).jtable("load")},b.Report=function(b){tze.showProcess(),a.ajax({url:"func/report_tickets.php",data:{Date:b,mode:"admin"},type:"POST",dataType:"binary",success:function(b,c,d){var e=d.getResponseHeader("Content-Disposition").replace("attachment;filename=","");if(navigator.userAgent.match(/Trident/))tze.hideProcess(),window.navigator.msSaveOrOpenBlob(b,e);else{var f=window.URL.createObjectURL(b),g=a("<a />",{"class":"text-center btn btn-default",id:"reportDownload",href:f,download:e,text:"Download starten"});a(document).one("click","a#reportDownload",function(){setTimeout(function(){window.URL.revokeObjectURL(f)},1e3)}),g.hide().appendTo("body")[0].click(),tze.hideProcess()}}})},b.childperTA=function(b,c,d){var e=c.id,f=c.userId||d?d.userId:void 0,g=a.param({id:e,userId:f});this.$jtable.jtable("openChildTable",b.closest("tr"),{title:"Aufstellung nach Tickets",fields:{ticketId:{},done_tickets:{},sum_counter:{},sum_duration:{}},actions:{listAction:function(){return actionFunc("func/tickets.php","mode=admin&action=list-ticket-classes&"+g)}}},function(a){a.childTable.jtable("load")})},b.childperMA=function(c,d){var e=a.param({id:d.id});this.$jtable.jtable("openChildTable",c.closest("tr"),{title:"Aufstellung nach Mitarbeiter",fields:{userId:{key:!0,list:!1},sVorname:{title:"Vorname",width:"25%"},sNachname:{title:"Nachname",width:"25%"},Tickets:{title:"Zusammenfassung",width:"35%"},perTA:{title:"",width:"15%",display:function(c){var e=a("<button>per Ticket</button>");return e.on("click",function(){b.childperTA(e,c,d)}),e}}},actions:{listAction:function(){return actionFunc("func/tickets.php","mode=admin&action=list-ma&"+e)}}},function(a){a.childTable.jtable("load")})},b.destroy=function(){this.$jtable.jtable("destroy")},b}(jQuery),zeiterfassung=function(a){var b={};return b.filter={init:function(b){a(b).empty(),a.post("func/projekte.php",{mode:"admin",action:"projekt-list"},function(c){"OK"===c.Result&&a.each(c.Records,function(c,d){var e=a('<a href="#zeiterfassung" class="filter list-group-item"></a>');e.text(d.Projekt).data("filter",{id:d.id,typ:"Projekt"}),a(b).append(e)})},"json")}},b.init=function(){this.jtable=a("#jtable_ZE");var c=this.jtable;c.jtable({title:"&nbsp;",openChildAsAccordion:!0,fields:{iUserID:{key:!0,list:!1},sVorname:{title:"Vorname",width:"25%"},sNachname:{title:"Nachname",width:"25%"},AZ:{title:"Arbeit",width:"10%",display:function(a){var b=a.record.AZ||"",c="";return 1===a.record.working&&(c="clockme"),'<time class="'+c+'">'+b+"</time>"}},PZ:{title:"Pause",width:"10%",display:function(a){var b=a.record.PZ||"",c="";return 0===a.record.working&&(c="clockme"),'<time class="'+c+'">'+b+"</time>"}},Projekt:{title:"Projekt",width:"15%"},Status:{title:"Status",width:"10%"},Details:{width:"5%",sorting:!1,display:function(b){var c=a("<button>Details</button>");return c.on("click",function(){a("#jtable_ZE").jtable("openChildTable",c.closest("tr"),{sorting:!0,defaultSorting:"Time_Start ASC",title:"Detailansicht - "+b.record.sVorname+" "+b.record.sNachname,fields:{id:{key:!0,list:!1},iProjekt:{title:"Projekt",list:!1,type:"radiobutton",options:getOptions("func/zeiterfassung.php","mode=admin&action=get-users-projekts&iUserId="+b.record.iUserID)},iCat:{title:"Art",list:!1,type:"radiobutton",options:getOptions("func/zeiterfassung.php","mode=admin&action=get-users-classes&iUserId="+b.record.iUserID)},Eintrag:{title:"Eintrag",create:!1,edit:!1,width:"55%",display:function(a){return a.record.Projekt+" "+a.record.ListLabel}},Time_Start:{title:"von",width:"15%",display:function(a){return a.record.Time_Start.substr(-8)},input:function(b){var c,d=new Date,e=d.toTimeString().substr(0,8),f=a("#datepicker").val();return c=b.record?a('<input type="text" name="Time_Start" value="'+b.record.Time_Start+'">').datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:ss",controlType:"select",oneLine:!0,parse:"loose"}):a('<input type="text" name="Time_Start" value="'+f+" "+e+'">').datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:ss",controlType:"select",oneLine:!0,parse:"loose"})}},Time_End:{title:"bis",width:"15%",display:function(a){var b=a.record.Time_End.substr(-8);return"00:00:00"===b&&(b="offen"),b},input:function(b){var c,d=new Date,e=d.toTimeString().substr(0,8),f=a("#datepicker").val();return c=b.record?a('<input type="text" name="Time_End" value="'+b.record.Time_End+'"></div>').datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:ss",controlType:"select",oneLine:!0,parse:"loose"}):a('<input type="text" name="Time_End" value="'+f+" "+e+'">').datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"HH:mm:ss",controlType:"select",oneLine:!0,parse:"loose"})}},Duration:{title:"Dauer",width:"15%",create:!1,edit:!1}},actions:{listAction:function(){var c=a("#datepicker").val();return actionFunc("func/zeiterfassung.php","mode=admin&action=get-users-timetable&Date="+c+"&iUserID="+b.record.iUserID)},createAction:function(c){var d=a("#datepicker").val();return actionFunc("func/zeiterfassung.php","mode=admin&action=insert-users-timetable&Date="+d+"&iUserID="+b.record.iUserID+"&"+c)},updateAction:function(a){return actionFunc("func/zeiterfassung.php","mode=admin&action=update-users-timetable&"+a)},deleteAction:function(a){return actionFunc("func/zeiterfassung.php","mode=admin&action=delete-users-timetable&id="+a.id)}},rowInserted:function(b,c){"Pause"===c.record.ListLabel&&a(c.row).addClass("info").closest("table").addClass("table"),"Meeting"===c.record.ListLabel&&a(c.row).addClass("danger").closest("table").addClass("table"),"Sonstiges"===c.record.ListLabel&&a(c.row).addClass("warning").closest("table").addClass("table")},rowUpdated:function(b,c){"Pause"===c.record.ListLabel?a(c.row).addClass("info").removeClass("danger warning").closest("table").addClass("table"):"Meeting"===c.record.ListLabel?a(c.row).addClass("danger").removeClass("info warning").closest("table").addClass("table"):"Sonstiges"===c.record.ListLabel?a(c.row).addClass("warning").removeClass("danger info").closest("table").addClass("table"):a(c.row).removeClass("warning danger info").closest("table").addClass("table")}},function(a){a.childTable.jtable("load")})}),c}}},actions:{listAction:function(b,c){return actionFunc("func/zeiterfassung.php","mode=admin&action=get-users&Date="+a("#datepicker").val(),c,b,[{key:"last",elem:"#filter"}])}},toolbar:{hoverAnimation:!0,hoverAnimationDuration:60,hoverAnimationEasing:void 0,items:[{text:'<div><input id="autoreload" style="margin: 0;" type="checkbox" /><span class="hidden glyphicon glyphicon-refresh"></span> AutoUpdate</div>',click:function(){b.toggleUpdater()}},{text:'<div><span class="glyphicon glyphicon-refresh"></span> Aktualisieren</div>',click:function(){c.jtable("reload")}},{text:'<div><span class="glyphicon glyphicon-download-alt"></span> Excel-Report</div>',click:function(){var b=a("#datepicker").val();zeiterfassung.Report(b)}}]},rowInserted:function(b,c){null===c.record.AZ&&a(c.row).addClass("danger").closest("table").addClass("table"),"Pause"===c.record.Status&&a(c.row).addClass("info").closest("table").addClass("table"),"Meeting"===c.record.Status&&a(c.row).addClass("warning").closest("table").addClass("table")},loadingAnimationDelay:100,sorting:!0}),a("a[href=#loggedOnly]").data("filter",{typ:"Projekt",action:"toggle",ele:"loggedOnly"}),a("#zeiterfassung").on("click","a.filter",function(b){b.preventDefault();var c=a(this),d=c.data("filter")||!1,e=a("#filter").data("filter")||{};d?("toggle"===d.action&&void 0!==d.ele&&(d[d.ele]=!d[d.ele],d[d.ele]?c.addClass("active"):c.removeClass("active")),a("#filter").data("filter",a.extend(e,d)),d.typ!==e.typ||d.id!==e.id||d.action||c.addClass("active").siblings().removeClass("active"),e.id?a("#jtable_ZE").jtable("load",{filter:e.typ,filterId:e.id,loggedOnly:!!e.loggedOnly}):a("#jtable_ZE").jtable("load",{loggedOnly:!!e.loggedOnly})):(a.extend(a("#filter a[href=#loggedOnly]").data("filter"),{loggedOnly:!1}),c.siblings().removeClass("active").children().removeClass("active"),a("#filter").removeData("filter"),a("#jtable_ZE").jtable("load"))})},b.toggleUpdater=function(){clearTimeout(b.timeout),b.timeout=setTimeout(function(){var c=a("#autoreload").data("checked");c=void 0!==c?c:!1,c?(console.log("AutoUpdate deaktiviert"),clearTimeout(b.autoUpdateTimer),void 0!==b.updateRequest&&b.updateRequest.abort(),a("#autoreload").data("checked",!1),a("#autoreload").prop("checked",!1)):(console.log("AutoUpdate aktiviert"),b.autoUpdate(),a("#autoreload").data("checked",!0),a("#autoreload").prop("checked",!0))},100)},b.autoUpdate=function(){if(a.active>0)a(document).one("ajaxStop",function(){b.autoUpdate()});else{var c=a("#filter").data(),d=a.param({mode:"admin",action:"get-users-update",last:c.last});if(void 0!==c.filter){var e=a.param(c.filter);e.length>0&&(d+="&"+e)}b.updateRequest=a.post("func/zeiterfassung.php",d,function(c){if(delete b.updateRequest,"OK"===c.Result){a("#filter").data("last",c.last),a.each(c.Records,function(){b.updateRow(this)});var d=a("#autoreload").prop("checked");d&&(b.autoUpdateTimer=setTimeout(function(){b.autoUpdate()},2e3))}},"json")}},b.updateRow=function(a){this.jtable.jtable("updateRecord",{record:a,clientOnly:!0})},b.Report=function(b){tze.showProcess(),a.ajax({url:"func/report.php",data:{Date:b,mode:"admin"},type:"POST",dataType:"binary",success:function(b,c,d){var e=d.getResponseHeader("Content-Disposition").replace("attachment;filename=","");if(navigator.userAgent.match(/Trident/))tze.hideProcess(),window.navigator.msSaveOrOpenBlob(b,e);else{var f=window.URL.createObjectURL(b),g=a("<a />",{"class":"text-center btn btn-default",id:"reportDownload",href:f,download:e,text:"Download starten"});a(document).one("click","a#reportDownload",function(){setTimeout(function(){window.URL.revokeObjectURL(f)},1e3)}),g.hide().appendTo("body")[0].click(),tze.hideProcess()}}})},b}(jQuery);$(document).ready(function(){$('a[data-toggle="tab"]').on("show.bs.tab",function(a){window.location.href=$(a.target).attr("href"),"#mitarbeiter"===$(a.target).attr("href")?(mitarbeiter.init(),$("#mitarbeiter").jtable("load")):"#mitarbeiter"===$(a.relatedTarget).attr("href")&&$("#mitarbeiter").jtable("destroy"),"#projekte"===$(a.target).attr("href")?(projekte.init(),$("#projekte").jtable("load")):"#projekte"===$(a.relatedTarget).attr("href")&&$("#projekte").jtable("destroy"),"#zugriff"===$(a.target).attr("href")?$("#zugriff").jtable({title:"&nbsp;",fields:{id:{key:!0,list:!1},name:{title:"Name"},ip_range:{title:"IP-Range"}},actions:{listAction:function(){return actionFunc("func/ip_range.php","mode=admin&action=list")},updateAction:function(a){return actionFunc("func/ip_range.php","mode=admin&action=update&"+a)},deleteAction:function(a){return actionFunc("func/ip_range.php","mode=admin&action=delete&id="+a.id)},createAction:function(a){return actionFunc("func/ip_range.php","mode=admin&action=create&"+a)}}}).jtable("load"):"#zugriff"===$(a.relatedTarget).attr("href")&&$("#zugriff").jtable("destroy"),"#zeiterfassung"===$(a.target).attr("href")?($("#datepicker").datepicker({dateFormat:"yy-mm-dd"}).on("change",function(){$("#jtable_ZE").jtable("load")}),zeiterfassung.init(),$("#projekt-toggle").on("show.bs.collapse",function(a){zeiterfassung.filter.init("#projekt-toggle")}),$("#jtable_ZE").jtable("load")):"#zeiterfassung"===$(a.relatedTarget).attr("href")&&$("#jtable_ZE").jtable("destroy"),"#tickets"===$(a.target).attr("href")?tickets.init("#jtable_Tickets","#datepicker_tickets"):"#tickets"===$(a.relatedTarget).attr("href")&&tickets.destroy(),"#dispocodes"===$(a.target).attr("href")?dispocodes.init("#dispocodes"):"#dispocodes"===$(a.relatedTarget).attr("href")&&dispocodes.destroy()});var a=$(location).attr("hash").split("/");if(""!==a[0])try{$("a[href="+a[0]+"]").tab("show")}catch(b){var c='<div class="alert alert-warning alert-dismissible"><button type="button" class="close" data-dismiss="alert" aria-label="Schließen"><span aria-hidden="true">&times;</span></button><strong>Hinweis:</strong> Die Unterseite <span class="text-info">'+a[0]+"</span> konnte nicht aufgerufen werden!</div>";$("#main").prepend(c)}$(".m-app-loading").fadeOut(function(){$(".m-app-loading").remove()})});